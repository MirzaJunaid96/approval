name: Environment Pipeline Trigger

on:
  issues:
    types:
      - closed
  push:
  workflow_dispatch:

jobs:
  trigger_pipeline:
    runs-on: ubuntu-latest

    steps:
      - name: Check if issue is closed
        id: check_issue
        run: echo "::set-output name=closed::${{ github.event_name == 'issues' && github.event.action == 'closed' }}"

      - name: Check environment label
        id: check_environment
        if: steps.check_issue.outputs.closed == 'true'
        run: echo "::set-output name=environment::${{ github.event.issue.labels.*.name }}"

      - name: Trigger pipeline
        if: steps.check_issue.outputs.closed == 'true' && steps.check_environment.outputs.environment == 'stage'
        run: |
          # Your pipeline trigger code for the 'stage' environment goes here
          echo "Pipeline for Stage Environment triggered."

      # Add similar steps for other environments (dev, qa) as needed
